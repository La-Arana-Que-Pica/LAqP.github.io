<link rel="icon" href="img/Logo Web.png" type="image/png" sizes="32x32">
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Liga - LAqP</title>
  <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <!-- Rediseño detalle liga -->
  <style>
    :root{
      --lg-head-bg:linear-gradient(180deg,rgba(14,16,26,.92),rgba(10,10,14,.94));
      --lg-border:1px solid rgba(255,255,255,.06);
      --lg-radius:20px;
      --lg-shadow:0 24px 90px rgba(0,0,0,.65);
    }

    .league-header{
      display:flex;
      gap:20px;
      align-items:center;
      margin:20px 0 24px;
      background:var(--lg-head-bg);
      border:var(--lg-border);
      border-radius:var(--lg-radius);
      padding:20px 24px;
      position:relative;
      overflow:hidden;
      box-shadow:var(--lg-shadow);
      isolation:isolate;
    }
    .league-header::before{
      content:"";
      position:absolute;inset:0;
      background:
        radial-gradient(700px 260px at 120% -10%,rgba(0,255,231,.20),transparent 70%),
        radial-gradient(700px 260px at -10% 120%,rgba(255,0,170,.18),transparent 70%);
      mix-blend-mode:screen;
      opacity:.55;
      pointer-events:none;
      z-index:-1;
    }
    .league-logo{
      width:110px;
      height:110px;
      border-radius:26px;
      object-fit:cover;
      border:2px solid rgba(255,255,255,.10);
      background:#000;
      box-shadow:0 16px 50px rgba(0,0,0,.55),0 0 26px rgba(0,255,231,.30),0 0 22px rgba(255,0,170,.28);
      flex-shrink:0;
    }
    .league-head-info{
      display:flex;
      flex-direction:column;
      gap:10px;
      min-width:0;
    }
    .league-title{
      margin:0;
      font-family:'Press Start 2P',monospace;
      font-size:1.4rem;
      letter-spacing:.9px;
      color:#fff;
      text-shadow:2px 0 var(--neon-cyan), -2px 0 var(--neon-pink);
      word-break:break-word;
    }
    .league-meta{
      font-size:.9rem;
      color:#cfecec;
      letter-spacing:.45px;
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .flag{
      width:32px;
      height:22px;
      object-fit:cover;
      border-radius:6px;
      border:1px solid rgba(255,255,255,.35);
      box-shadow:0 0 10px rgba(0,0,0,.55);
    }

    .team-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
      gap:18px;
      margin-top:10px;
    }
    .team-link{
      position:relative;
      display:flex;
      gap:14px;
      align-items:center;
      padding:16px 16px 14px;
      background:linear-gradient(180deg,rgba(16,18,28,.92),rgba(12,12,16,.94));
      border:1px solid rgba(255,255,255,.06);
      border-radius:18px;
      text-decoration:none;
      color:inherit;
      box-shadow:0 18px 60px rgba(0,0,0,.6);
      overflow:hidden;
      transition:.25s cubic-bezier(.2,.9,.3,1);
      isolation:isolate;
    }
    .team-link::before{
      content:"";
      position:absolute;inset:0;
      background:
        radial-gradient(520px 180px at 120% -10%,rgba(0,255,231,.16),transparent 70%),
        radial-gradient(520px 180px at -10% 120%,rgba(255,0,170,.14),transparent 70%);
      mix-blend-mode:screen;
      opacity:.55;
      pointer-events:none;
      z-index:-1;
    }
    .team-link:hover{
      transform:translateY(-6px);
      box-shadow:0 26px 90px rgba(0,0,0,.7),0 0 24px rgba(0,255,231,.30),0 0 18px rgba(255,0,170,.28);
      border-color:rgba(0,255,231,.35);
    }
    .team-logo{
      width:70px;
      height:70px;
      border-radius:16px;
      object-fit:cover;
      border:2px solid rgba(255,255,255,.10);
      background:#000;
      box-shadow:0 12px 34px rgba(0,0,0,.55),0 0 16px rgba(0,255,231,.25),0 0 14px rgba(255,0,170,.22);
      flex-shrink:0;
    }
    .team-name{
      font-family:'Bungee','Press Start 2P',monospace;
      font-size:1rem;
      color:#fff;
      letter-spacing:.5px;
      line-height:1.05;
    }

    .no-results{
      grid-column:1/-1;
      padding:18px;
      background:linear-gradient(180deg,rgba(24,26,36,.85),rgba(12,12,16,.85));
      border:1px solid rgba(255,255,255,.06);
      border-radius:16px;
      font-size:.9rem;
      color:#dff;
      text-align:center;
      box-shadow:0 12px 40px rgba(0,0,0,.55);
    }

    @media (max-width:700px){
      .league-header{flex-wrap:wrap;padding:18px 20px}
      .league-logo{width:92px;height:92px}
      .team-grid{grid-template-columns:repeat(auto-fill,minmax(220px,1fr))}
      .team-logo{width:62px;height:62px}
      .league-title{font-size:1.2rem}
    }
  </style>
</head>
<body>
    <!-- Page background (blurred + darkened) - uses the image you uploaded at img/fondo -->
  <div class="page-bg" aria-hidden="true"></div>
  
  <div class="wrap">
    <header class="site-header" role="banner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1><a href="index.html" class="clean" style="color:inherit;text-decoration:none">LAqP</a></h1>
      </div>
      <nav class="main-nav" role="navigation">
        <a href="ligas.html">Ligas</a>
        <a href="equipos.html">Equipos</a>
        <a href="jugadores.html">Jugadores</a>
      </nav>
    </header>

    <div id="content"></div>

    <footer class="site-footer">© La Araña Que Pica — Página Oficial</footer>
  </div>

  <script src="js/db.js"></script>
  <script>
    (async function(){
      const $c=document.getElementById('content');
      const slug=DB.getParam('slug');
      if(!slug){ $c.innerHTML='<div class="no-results">Liga no especificada.</div>'; return; }

      // Helper bandera: intenta primero archivo con acentos/ñ tal cual; si falla, usa versión normalizada de DB.countryFlagSrc
      function flagSrcWithAccents(country){
        if(!country) return '';
        const base = String(country).replace(/\.(png|jpe?g|webp|gif|svg)$/i,'').trim();
        return `img/flags/${encodeURIComponent(base)}.png`;
      }

      let leagues, teams;
      try{
        ({ leagues, teams } = await DB.load({ leagues:true, teams:true }));
      }catch(e){
        $c.innerHTML='<div class="no-results">Error cargando data.</div>';
        return;
      }
      const league=leagues.find(l=>l.slug===slug);
      if(!league){ $c.innerHTML='<div class="no-results">Liga no encontrada.</div>'; return; }

      const teamsInLeague=teams.filter(t=>String(t.league_id)===String(league.id))
                               .sort((a,b)=>a.name.localeCompare(b.name,'es'));

      const headerHTML=`
        <section class="league-header">
          <img class="league-logo" src="${league.logo||'img/ligas/placeholder.png'}" alt="${league.name}" onerror="this.src='img/ligas/placeholder.png'">
          <div class="league-head-info">
            <h2 class="league-title">${league.name}</h2>
            <div class="league-meta">
              <span>${league.country}</span>
              <img class="flag"
                   src="${flagSrcWithAccents(league.country)}"
                   alt="${league.country}"
                   onerror="if(!this.dataset.try2){this.dataset.try2=1;this.src='${DB.countryFlagSrc(league.country)}'}else{this.style.display='none'}">
            </div>
          </div>
        </section>
      `;
      $c.innerHTML=headerHTML;

      const grid=document.createElement('div');
      grid.className='team-grid';

      if(teamsInLeague.length===0){
        grid.innerHTML='<div class="no-results">Sin equipos cargados para esta liga.</div>';
      }else{
        for(const t of teamsInLeague){
          const a=document.createElement('a');
          a.className='team-link';
          a.href=`equipo.html?slug=${encodeURIComponent(t.slug)}`;
          a.innerHTML=`
            <img class="team-logo" src="${t.logo||'img/equipos/placeholder.png'}" alt="${t.name}" onerror="this.src='img/equipos/placeholder.png'">
            <div class="team-name">${t.name}</div>
          `;
          grid.appendChild(a);
        }
      }
      $c.appendChild(grid);
    })();
  </script>
</body>
</html>